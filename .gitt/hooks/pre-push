#!/bin/bash
# Block unsigned commits before pushing

# Find unsigned commits between local HEAD and remote
UNSIGNED=$(git log origin/$(git rev-parse --abbrev-ref HEAD)..HEAD --pretty=format:"%H %G?" | grep -v " G")

if [ -n "$UNSIGNED" ]; then
  echo "❌ Push blocked: Unsigned commits detected!"
  echo "$UNSIGNED"
  echo "Please sign your commits before pushing."
  exit 1
fi

echo "✅ All commits are signed. Push allowed."
exit 0
